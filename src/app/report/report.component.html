<div id="report" class="container-fluid">
  <div class="container">
    <div class="jumbotron text-center">
      <div class="page-header">
        <h2>{{title}}</h2>
      </div>
      <div class="addInfo">
          {{addInfo}}<br>
          <h4>
            <b>Sales Report</b>
          </h4>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="selectMachines">
        <div class="dropdown col-sm-2 text-center">
            <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown">
              {{cluster}}
            </button>
            <div class="dropdown-menu">
              <span *ngFor="let clusterName of Cluster.clusters">
              <a class="dropdown-item" (click)="cluster = clusterName;selectedIds=[];id=[]; getIds()" *ngIf="global.user['0'][clusterName]==1" >{{clusterName}}</a>
              </span>
            </div>
        </div>
        <div class="col-sm-2" *ngIf="isActive">
          <ng-multiselect-dropdown
              [placeholder]="'Select Ids'"
              [data]="ids"
              [(ngModel)]="id"
              [settings]="dropdowntableSettings"
              (onSelect)="onItemSelect($event)"
              (onSelectAll)="onSelectAll($event)"
              (onDeSelectAll)="onDeSelectAll($event)"
              (onDeSelect)="onDeSelect($event)">
          </ng-multiselect-dropdown>
        </div>
    </div>


  </div>
  <div class="dateRange text-center">
    <form >
      <div class="form-group">
          <label class="sel"><h5>Select a Date Range</h5> </label>
          <span class="dateInput">
              <label class="pad">From: </label>
              <input type="date" placeholder="mm/dd/yyyy" class="form-control form-control-sm" name="from" [(ngModel)]="from"(click)="this.selectedparameter[0]=[];chartsActive=[false,false];tableActive=false">
              <label class="pad">To: </label>
              <input type="date" placeholder="mm/dd/yyyy" class="form-control form-control-sm" name="to" [(ngModel)]="to" (click)="this.selectedparameter[0]=[];chartsActive=[false,false];tableActive=false">
          </span>

      </div>
    </form>
</div>
<div class="col-sm-12 charts" *ngFor="let chart of charts;let rowIndex =index;">
  <div class="row polar" *ngIf="chartsActive[0]||rowIndex==0">
    <div class="header" *ngIf="rowIndex==1">
      <h5>Compare Single Parameter</h5>
    </div>
    <div class="select col-sm-3">
      <ng-multiselect-dropdown (click)="tableActive=false"
        [placeholder]="rowIndex?'Select Parameter':'Select Parameters'"
        [data]="parameters[rowIndex]"
        [(ngModel)]="selectedparameter[rowIndex]"
        [settings]="chart"
        (onSelect)="setChartData($event,rowIndex)"
        (onSelectAll)="setChartData($event,rowIndex)"
        (onDeSelect)="setChartData($event,rowIndex)"
        (onDeSelectAll)="emptyChartData()"

        >
      </ng-multiselect-dropdown>
    </div>
    <span class="button">
      <button type="submit" class="btn btn-info" (click)="generateReport()" *ngIf="rowIndex==0">Visualize Data  </button>
    </span>
    </div>
    <div class="row">
      <div class="chart col-sm-9" *ngIf="chartsActive[rowIndex]">
        <app-analysis-charts [property]="chartData[rowIndex][0]" [chartData]="chartData[rowIndex][1]" [ids]="chartData[rowIndex][2]" [ty]="chartData[rowIndex][3]" ></app-analysis-charts>
      </div>
  </div>
</div>
<div class="row">
  <span class="button reportbtn">
    <button type="submit" class="btn btn-info" (click)="tableActive=true;" *ngIf="chartsActive[0]">Generate Report</button>
  </span>
</div>

<div class="col-sm-12 table" *ngIf="tableActive">
    <div class="row" >
        <div class="page-header" *ngFor="let id of selectedIds">
          <span class="heading">
              <h3>
                  Id : {{id}}
                  <i class="fas fa-download" (click)="print(id)"></i>
                </h3>
              </span>
              <div id="{{id}}">
                <table class="table table-striped text-center" >
                  <thead class="thead-dark">
                    <tr>
                      <th>Date</th>
                      <th *ngFor="let data of selectedparameter[0]">{{data.title}}</th>
                    </tr>
                  </thead>
                  <tbody >
                    <tr *ngFor="let info of tableData[id];let rowIndex=index">
                      <td>{{info["date"]}}</td>
                      <td *ngFor="let data of selectedparameter[0]">{{info[data.name]}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
        </div>      
      </div>
</div>

</div>
